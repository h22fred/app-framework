function maf_confirmAction(b){return window.confirm(b)}function maf_password_rating(b){if(8>b.length)return 0;var a=0;b.match("[a-z]+")&&a++;b.match("[A-Z]+")&&a++;b.match("[0-9]+")&&a++;b.match("[`~!@#\\$%\\^&\\*\\(\\)_\\-\\+=\\{\\}\\[\\]\\\\\\|:;\"'<>,\\.\\?\\/]+")&&a++;return 2>a?0:2<a?2:1}function maf_formatNumber(b,a){return b.toFixed(Math.max(a,(b.toString().split(".")[1]||[]).length))} function maf_performPostJsonReceiveHtml(b,a,d,e){maf_performPost("application/json; charset=utf-8","html",b,a,d,e)}function maf_performPostJsonReceiveJson(b,a,d,e){maf_performPost("application/json; charset=utf-8","json",b,a,d,e)}function maf_performPost(b,a,d,e,c,g){$.ajax({type:"POST",dataType:a,contentType:b,url:d,data:e}).done(c).fail(g)} function maf_load_value_holders_in_select(b,a){var d=$.map(a,function(a,b){return[a]});d.sort(maf_sort_value_holder);$("#"+b).html("");for(var e=0;e<d.length;e++){var c=d[e];$("#"+b).append($("<option>",{value:c.value,text:c.name}))}}function maf_sort_value_holder(b,a){return b.name<a.name?-1:b.name>a.name?1:0}function maf_diff_valueholders_collection(b,a){var d={},e;for(e in b){var c=b[e];a[e]||(d[c.value]=c)}return d} function maf_queryString(b){var a=null;b=(new RegExp("[\\?&#]"+b+"=([^&#]*)")).exec("?"+window.location.href.split("?")[1]);null!=b&&(a=decodeURIComponent(b[1].replace(/\+/g," ")));return a} function maf_displayErrors(b,a,d){$("#"+b+' [id*="_field"] .help-inline').html("");if($.isEmptyObject(a))$("#"+b+' [id*="_field"] .help-inline').html(""),$("#"+b+"_errors").css("display","none"),$("#"+b+"_errors strong").html("");else for(fieldName in $("#"+b+"_errors").css("display","inline"),$("#"+b+"_errors strong").html(d),a)$("#"+b+" #"+fieldName+"_field .help-inline").html(a[fieldName])}function maf_flashErrorMessage(b){maf_flashMessage(b,"alert-error")} function maf_flashSuccessMessage(b){maf_flashMessage(b,"alert-success")}function maf_clearFlash(b){maf_flashHtmlContent("")}function maf_flashMessage(b,a){maf_flashHtmlContent('<div class="alert '+a+'">'+b+"</div>")}function maf_flashHtmlContent(b){$("#maf-flash-message").html(b)} function maf_sort(b,a,d){var e=window[b],c=$(a);b=c.find('i[class*="glyphicons"]');a="glyphicons glyphicons-chevron-down"==b.attr("class");var g=$("#"+d+" th").index(c),f=[];$("#"+d+" tr").each(function(a){var b=$(this).attr("id");b&&(a={},a.id=b,b=$(this).find("td:eq("+g+")").text(),a.value=b,f.push(a))});f.sort(function(a,b){var c=a.id.toLowerCase(),d=b.id.toLowerCase();return c<d?-1:c>d?1:0});f.sort(function(a,b){return e(a,b)});a&&f.reverse();d=$("#"+d+" tbody");for(c=0;c<f.length;c++){var h= $("#"+f[c].id);h.remove();d.prepend(h)}a?b.removeClass("glyphicons-chevron-down").addClass("glyphicons-chevron-up"):b.removeClass("glyphicons-chevron-up").addClass("glyphicons-chevron-down")}function maf_stringSort(b,a){var d=b.value.toLowerCase(),e=a.value.toLowerCase();return d<e?-1:d>e?1:0}function maf_numberSort(b,a){return b.value-a.value} function maf_dateSort(b,a){try{dateA=b.value.split("/");var d=new Date(dateA[2],dateA[1]-1,dateA[0]);dateB=a.value.split("/");var e=new Date(dateB[2],dateB[1]-1,dateB[0])}catch(c){d=new Date(b.value),e=new Date(a.value)}return d-e} function maf_dateAndTimeSort(b,a){try{dateA=b.value.split("/");dayHoursMinA=dateA[2].split(" ");hoursMinA=dayHoursMinA[1].split(":");var d=new Date(dayHoursMinA[0],dateA[1]-1,dateA[0],hoursMinA[0],hoursMinA[1],0,0);dateB=a.value.split("/");dayHoursMinB=dateB[2].split(" ");hoursMinB=dayHoursMinB[1].split(":");var e=new Date(dayHoursMinB[0],dateB[1]-1,dateB[0],hoursMinB[0],hoursMinB[1],0,0)}catch(c){d=new Date(b.value),e=new Date(a.value)}return d-e} function maf_orderSort(b,a){return b.order-a.order} function maf_filter_sort_url(b,a,d){if(a){var e=a.userColumnConfiguration[b].sortType;if(e&&"NONE"!=e){"UNSORTED"==e&&(e=a.userColumnConfiguration[b].sortType="DESC");var c=$(column).find('i[class*="glyphicons"]');"glyphicons glyphicons-sort"==c.attr("class")&&("DESC"==e?c.removeClass("glyphicons-sort").addClass("glyphicons-chevron-up"):c.removeClass("glyphicons-sort").addClass("glyphicons-chevron-down"));"glyphicons glyphicons-chevron-down"==c.attr("class")?(a.userColumnConfiguration[b].sortType= "ASC",c.removeClass("glyphicons-chevron-down").addClass("glyphicons-chevron-up")):(a.userColumnConfiguration[b].sortType="DESC",c.removeClass("glyphicons-chevron-up").addClass("glyphicons-chevron-down"));d.apply()}}} function maf_filter_updateFilterContainer(b,a,d,e){$("#"+b+" li").each(function(a){a=$(this).attr("id");a=a.substring(11);d.userColumnConfiguration[a].isFiltered||$(this).remove()});for(columnId in d.userColumnConfiguration){var c=$("#"+b+" li#_filter_cp_"+columnId).length;if(d.userColumnConfiguration[columnId].isFiltered&&!c){c=d.selectableColumns[columnId];if("CHECKBOX"==c.type){var g={label:c.name,defaultValue:d.userColumnConfiguration[columnId].filterValue};maf_filter_addCheckboxField(b,columnId, a,g,d,e)}"TEXTFIELD"==c.type&&(g={label:c.name,defaultValue:d.userColumnConfiguration[columnId].filterValue},maf_filter_addTextField(b,columnId,a,g,d,e));"NUMERIC"==c.type&&(g={label:c.name,defaultValue:d.userColumnConfiguration[columnId].filterValue.value,defaultComparator:d.userColumnConfiguration[columnId].filterValue.comparator},maf_filter_addNumericField(b,columnId,a,g,d,e));"DATERANGE"==c.type&&(g={label:c.name,fromDefaultValue:new Date(d.userColumnConfiguration[columnId].filterValue.from), toDefaultValue:new Date(d.userColumnConfiguration[columnId].filterValue.to),format:c.format},maf_filter_addDateRangeField(b,columnId,a,g,d,e));"SELECT"==c.type&&(g={label:c.name,defaultValue:d.userColumnConfiguration[columnId].filterValue,values:c.values},maf_filter_addSelect(b,columnId,a,g,d,e));"AUTOCOMPLETE"==c.type&&(g={label:c.name,url:c.url,defaultValue:d.userColumnConfiguration[columnId].filterValue},maf_filter_addAutocomplete(b,columnId,a,g,d,e))}}} function maf_filter_prepareSortableColumns(b,a,d,e){for(columnId in d.userColumnConfiguration)if(d.userColumnConfiguration[columnId].isDisplayed&&"NONE"!=d.userColumnConfiguration[columnId].sortType){var c=$("#"+b+" th#_"+a+"_"+columnId),g=c.html();c.html("");var f=$("<a/>",{href:"#"});f.html(g+'&nbsp;<i class="glyphicons"></i>');c.append(f);c=$("#"+b+" th#_"+a+"_"+columnId+" a i");maf_filter_setSortOrder(c,columnId,d);f.click(function(a,b,c,d,e){return function(f){f.preventDefault();"DESC"==d.userColumnConfiguration[c].sortType? d.userColumnConfiguration[c].sortType="ASC":"ASC"==d.userColumnConfiguration[c].sortType?d.userColumnConfiguration[c].sortType="DESC":"UNSORTED"==d.userColumnConfiguration[c].sortType&&(d.userColumnConfiguration[c].sortType="ASC");f=$("#"+a+" th#_"+b+"_"+c+" a i");maf_filter_setSortOrder(f,c,d);for(otherColumnId in d.userColumnConfiguration)otherColumnId!=c&&"NONE"!=d.userColumnConfiguration[otherColumnId].sortType&&(d.userColumnConfiguration[otherColumnId].sortType="UNSORTED",f=$("#"+a+" th#_"+b+ "_"+otherColumnId+" a i"),maf_filter_setSortOrder(f,otherColumnId,d));e.apply()}}(b,a,columnId,d,e))}} function maf_filter_setSortOrder(b,a,d){"UNSORTED"==d.userColumnConfiguration[a].sortType&&(b.removeClass("glyphicons-chevron-up"),b.removeClass("glyphicons-chevron-down"));"DESC"==d.userColumnConfiguration[a].sortType&&(b.removeClass("glyphicons-chevron-up"),b.hasClass("glyphicons-chevron-down")||b.addClass("glyphicons-chevron-down"));"ASC"==d.userColumnConfiguration[a].sortType&&(b.removeClass("glyphicons-chevron-down"),b.hasClass("glyphicons-chevron-up")||b.addClass("glyphicons-chevron-up"))} function maf_filter_prepareColumnsSelector(b,a,d,e,c){var g=getSourceAndValueForDisplayedColumns(e);$("#"+a).editable({title:_maf_translations.columnsSelectorTitle,type:"checklist",placement:"bottom",showbuttons:"bottom",onblur:"submit",display:!1,value:g.value,source:g.source,success:function(a,g){var k=0;for(columnId in e.userColumnConfiguration)-1!=jQuery.inArray(k+"",g)?e.userColumnConfiguration[columnId].isDisplayed=!0:e.userColumnConfiguration[columnId].isDisplayed=!1,k++;k=getSourceAndValueForFilteredColumns(e); k.source.length?($("#"+d).show(),$("#"+d).editable("enable"),$("#"+d).editable("option","source",k.source),$("#"+d).editable("setValue",k.value)):($("#"+d).editable("disable"),$("#"+d).hide());maf_filter_updateFilterContainer(b,d,e,c);c.apply()}})} function maf_filter_prepareFiltersSelector(b,a,d,e){var c=getSourceAndValueForFilteredColumns(d);$("#"+a).editable({title:_maf_translations.filtersSelectorTitle,type:"checklist",placement:"bottom",showbuttons:"bottom",onblur:"submit",display:!1,value:c.value,source:c.source,success:function(c,f){var h=0;for(columnId in d.userColumnConfiguration)"NONE"!=d.selectableColumns[columnId].type&&(-1!=jQuery.inArray(h+"",f)?d.userColumnConfiguration[columnId].isFiltered=!0:d.userColumnConfiguration[columnId].isFiltered= !1,h++);d.currentPage=0;maf_filter_updateFilterContainer(b,a,d,e);e.apply()}})} function getSourceAndValueForDisplayedColumns(b){var a=0,d=0,e=[],c=[];for(columnId in b.userColumnConfiguration)c[a]={},c[a].value=a,c[a].isKpi=b.selectableColumns[columnId].isKpi,c[a].text="",b.selectableColumns[columnId].isKpi&&(c[a].text+=_maf_translations.kpi+" - "),c[a].text+=b.selectableColumns[columnId].name,b.userColumnConfiguration[columnId].isDisplayed&&(e[d]=a,d++),a++;c.sort(maf_sort_result_source);b={};b.value=e;b.source=c;return b} function getSourceAndValueForFilteredColumns(b){var a=0,d=0,e=[],c=[];for(columnId in b.userColumnConfiguration)"NONE"!=b.selectableColumns[columnId].type&&(c[a]={},c[a].value=a,c[a].isKpi=b.selectableColumns[columnId].isKpi,c[a].text="",b.selectableColumns[columnId].isKpi&&(c[a].text+=_maf_translations.kpi+" - "),c[a].text+=b.selectableColumns[columnId].name,b.userColumnConfiguration[columnId].isFiltered&&(e[d]=a,d++),a++);c.sort(maf_sort_result_source);b={};b.value=e;b.source=c;return b} function maf_sort_result_source(b,a){return 1==b.isKpi&&0==a.isKpi?1:0==b.isKpi&&1==a.isKpi||b.text<a.text?-1:b.text>a.text?1:0} function maf_filter_addCheckboxField(b,a,d,e,c,g){var f=maf_filter_construct_field_header(a,e);f.append("<br/>");var h=$("<a/>",{href:"#",id:a});f.append(h);$("#"+b).append(f);f=[];e.defaultValue&&(f[0]=1);$("#"+a).editable({title:e.label,type:"checklist",emptytext:_maf_translations.unchecked,value:f,source:[{value:1,text:_maf_translations.checked}],success:function(b,d){c.userColumnConfiguration[a].filterValue=0!=d.length;c.currentPage=0;g.apply()}});maf_filter_add_remove_event(b,a,d,c,g)} function maf_filter_addTextField(b,a,d,e,c,g){var f=maf_filter_construct_field_header(a,e);f.append("<br/>");var h=$("<a/>",{href:"#",id:a});f.append(h);$("#"+b).append(f);$("#"+a).editable({title:e.label,emptytext:_maf_translations.empty,type:"text",value:e.defaultValue,success:function(b,d){c.userColumnConfiguration[a].filterValue=d;c.currentPage=0;g.apply()}});maf_filter_add_remove_event(b,a,d,c,g)} function maf_filter_addNumericField(b,a,d,e,c,g){var f=maf_filter_construct_field_header(a,e);f.append("<br/>");var h=$("<a/>",{href:"#",id:a+"Comparator"});f.append(h);f.append("&nbsp;&nbsp;");h=$("<a/>",{href:"#",id:a});f.append(h);$("#"+b).append(f);$("#"+a).editable({title:e.label,emptytext:_maf_translations.empty,type:"text",value:e.defaultValue,success:function(b,d){c.userColumnConfiguration[a].filterValue||(c.userColumnConfiguration[a].filterValue={});c.currentPage=0;c.userColumnConfiguration[a].filterValue.value= d;g.apply()}});$("#"+a+"Comparator").editable({title:e.label,type:"select",value:e.defaultComparator,source:"= <> > >= < <=".split(" "),success:function(b,d){c.userColumnConfiguration[a].filterValue||(c.userColumnConfiguration[a].filterValue={});c.currentPage=0;c.userColumnConfiguration[a].filterValue.comparator=d;g.apply()}});maf_filter_add_remove_event(b,a,d,c,g)} function maf_filter_addDateRangeField(b,a,d,e,c,g){var f=maf_filter_construct_field_header(a,e);f.append("<br/>"+_maf_translations.from+"&nbsp;");var h=$("<a/>",{href:"#",id:a+"From"});f.append(h);f.append("&nbsp;"+_maf_translations.to+"&nbsp;");h=$("<a/>",{href:"#",id:a+"To"});f.append(h);$("#"+b).append(f);$("#"+a+"From").editable({placement:"bottom",type:"date",clear:!1,datepicker:{language:_maf_language},title:_maf_translations.from,value:e.fromDefaultValue,format:e.format,success:function(b, d){c.userColumnConfiguration[a].filterValue||(c.userColumnConfiguration[a].filterValue={});c.currentPage=0;c.userColumnConfiguration[a].filterValue.from=d;g.apply()}});$("#"+a+"To").editable({placement:"bottom",type:"date",clear:!1,datepicker:{language:_maf_language},title:_maf_translations.to,value:e.toDefaultValue,format:e.format,success:function(b,d){c.userColumnConfiguration[a].filterValue||(c.userColumnConfiguration[a].filterValue={});c.currentPage=0;c.userColumnConfiguration[a].filterValue.to= d;g.apply()}});maf_filter_add_remove_event(b,a,d,c,g)} function maf_filter_addSelect(b,a,d,e,c,g){var f=maf_filter_construct_field_header(a,e);f.append("<br/>");var h=$("<a/>",{href:"#",id:a});f.append(h);$("#"+b).append(f);f=[{}];f[0].value=0;f[0].text="";var h=0,k=1;for(key in e.values)f[k]={},f[k].value=k,f[k].text=e.values[key].name,f[k].order=e.values[key].order,e.values[key].value==e.defaultValue&&(h=k),k++;f.sort(maf_orderSort);$("#"+a).editable({title:e.label,type:"select",value:e.defaultValue,value:h,source:f,success:function(b,d){var f=parseInt(d); if(0==f)c.userColumnConfiguration[a].filterValue=0,c.currentPage=0,g.apply();else{var h=1;for(key in e.values)f==h&&(c.userColumnConfiguration[a].filterValue=key,c.currentPage=0,g.apply()),h++}}});maf_filter_add_remove_event(b,a,d,c,g)} function maf_filter_addAutocomplete(b,a,d,e,c,g){var f=maf_filter_construct_field_header(a,e);f.append('<div class="clearfix"></div>');var h=$("<a/>",{href:"#",id:"_"+a+"_editable"});f.append(h);var h=$("<input/>",{type:"hidden",name:a,id:a,value:""}),k=$("<input/>",{type:"hidden",name:a+"_content",id:a+"_content",value:""});f.append(h);f.append(k);h=$("<a/>",{href:"#",id:"_"+a+"_clear_editable","class":"btn btn-default btn-sm"});h.append($("<span/>",{"class":"glyphicons glyphicons-erase"}));f.append(" &nbsp;"); f.append(h);$("#"+b).append(f);$("#_"+a+"_clear_editable").click(function(b){b.preventDefault();$("#_"+a+"_editable").editable("setValue",null);$("#"+a).val(null);$("#"+a+"_content").val("");c.userColumnConfiguration[a].filterValue={value:null,content:""};c.currentPage=0;g.apply()});window[a+"_editableCache"]={};""!=e.defaultValue.content&&(window[a+"_editableCache"][e.defaultValue.value]={name:e.defaultValue.content});maf_activateEditable_for_autocomplete(window[a+"_editableCache"],a,e.defaultValue.value, "",e.url,"",function(b,d){c.userColumnConfiguration[a].filterValue={value:b,content:d};c.currentPage=0;g.apply()});maf_filter_add_remove_event(b,a,d,c,g)} function maf_filter_construct_field_header(b,a){var d=$("<li/>",{"class":"filter-input",id:"_filter_cp_"+b}),e=$("<div/>",{"class":"pull-left"}),c=$("<div/>",{"class":"pull-right"}),g=$("<a/>",{href:"#",id:"_filter_remove_"+b,html:"<span class='glyphicons glyphicons-remove-2'></span>"}),f=$("<strong/>",{text:a.label});e.append(f);c.append("&nbsp;&nbsp;");c.append(g);d.append(e);d.append(c);return d} function maf_filter_add_remove_event(b,a,d,e,c){$("#_filter_remove_"+a).click(function(g){g.preventDefault();e.userColumnConfiguration[a].isFiltered=!1;g=getSourceAndValueForFilteredColumns(e);$("#"+d).editable("setValue",g.value);e.currentPage=0;maf_filter_updateFilterContainer(b,d,e,c);c.apply()})} function maf_activateEditable_for_autocomplete(b,a,d,e,c,g,f){b[d]&&($("#"+a).val(d),$("#"+a+"_content").val(b[d].name));$("#_"+a+"_editable").editable({title:"fieldLabel",mode:"inline",type:"typeaheadjs",onblur:"submit",value:$("#"+a+"_content").val(),valueKey:"name",typeahead:{remote:{url:c+"?query=%QUERY"+g,filter:function(a){var c=[];for(value in a)b[value]=a[value],c.push(a[value].name);return c}}},validate:function(c){var d=!1;for(value in b)b[value].name==c&&(d=!0);if(!d)return{newValue:$("#"+ a+"_content").val()}},success:function(c,d){for(value in b)if(b[value].name==d){$("#"+a).val(value);$("#"+a+"_content").val(d);f&&f.apply(this,[value,d]);break}}})};